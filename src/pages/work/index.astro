---
import { getCollection } from "astro:content";
import PageLayout from "@layouts/PageLayout.astro";
import Container from "@components/Container.astro";
import BackToPrev from "@components/BackToPrev.astro";
import { SITE, WORK, SOCIALS } from "@consts";
import Link from "@components/Link.astro";

const collection = (await getCollection("work")).sort(
    (a, b) =>
        new Date(b.data.dateStart).valueOf() -
        new Date(a.data.dateStart).valueOf(),
);

const work = await Promise.all(
    collection.map(async (item) => {
        const { Content } = await item.render();
        return { ...item, Content };
    }),
);
---

<PageLayout title={WORK.TITLE} description={WORK.DESCRIPTION}>
    <Container>
    <div>
        <BackToPrev href="/">
            Back home
        </BackToPrev>
    </div>
        <div class="space-y-10">
        <div class="space-y-1 my-6">
        <div class="font-semibold text-center text-2xl text-black dark:text-white">
            ðŸ‘”
        </div>
        <div class="text-center text-black dark:text-white">
            {WORK.DESCRIPTION}
        </div>
        </div> 

        <ul class="flex flex-col space-y-4">
            {
                work.map((entry) => (
                    <li>
                    
                        <div class="text-sm opacity-75">
                                {entry.data.dateStart.toLocaleString("default", { month: "short" }) +
                                entry.data.dateStart.getFullYear().toString()}
                        </div>
                        <a href={entry.data.url} class="font-semibold text-black dark:text-white hover:underline" target="_blank" rel="noopener noreferrer">
                            {entry.data.company}
                        </a>
                        <div class="text-sm opacity-75">
                            {entry.data.role}
                        </div>
                        <article>
                            <entry.Content />
                        </article>

                    </li>
                    
                ))
            }
        </ul>
        
        <div class="my-6 flex justify-center">
            <div class="rounded-xl bg-gray-100/20 dark:bg-gray-800/20 px-6 py-3 text-center text-gray-700 dark:text-gray-200 border border-gray-200 dark:border-gray-700 max-w">
                Want the full resume? <a href={`mailto:${SITE.EMAIL}`} class="underline font-semibold hover:text-violet-700 dark:hover:text-violet-300">Shoot me an email</a> and I'll send it over!
            </div>
        </div>

    </div>
    </Container>
</PageLayout>
